
首先我先简要介绍一下用户导入的csv格式文件文件，这是一个Recipe文件，他的作用是告诉机台在平面上每一个点位置对应的运动速度：
A列为编号，从A1=1开始A2=2，一直到A9027=9027。
B列为X轴的坐标
D列为Y轴的坐标
C列为坐标在B列和D列确定的该点x轴方向的速度
E列为坐标在B列和D列确定的该点y轴方向的速度。

然后真正开始处理的时候需要“掐头去尾”，即去掉第一行和最后一行（第9027行），因为这两行仅用于让机台知道recipe的开始和结束。
首先X轴坐标共95个值，Y轴坐标共95个值，因此一共有95*95=9025个坐标，即共有9025行是需要，（加上第一行和最后一行一共9027行）

我提供了一个WedgeTestRecipe文件给你，你可以参考。这个程序用户使用的时候需要提供WedgeTestRecipe，虽然点坐标的位置和位置对应的运动速度会发生变化，但都满足95*95的点阵大小。因此需要创建一个二维数组来存放“1. 坐标编号，2. x轴坐标，3.y轴坐标 4.x轴的速度， 5.y轴的速度”这些量。也就是说，我需要创建一个95*95的二维数组，每一个单元存放Map的5个信息——坐标编号，Map-WTR的x轴坐标，Map-WTR的y轴坐标，Map-WTR的x轴速度，Map-WTR的y轴速度。

我们先把WedgeTestRecipe的95*95的点阵的Map称为Map-WTR（WTR代表WedgeTestRecipe）接下来我需要把这个95*95的Map的坐标映射到另外一个95*95的Map上，我称另一套Map为Map-TM（TM代表TrimmingAmount），Map-WTR的每一个点都唯一映射到Map-TM，大小虽然一样，但是坐标位置不一样，并且不是简单的平移。同时新的Map对应的二维数组每一个单元需要存放的信息也不一样。

映射方式是这样的，首先确定Map-WTR的中心点的坐标，假设为记为（Xc，Yc）c代表center。则Map-WTR的x轴坐标映射到Map-TM的转换方式为xWTR-Xc=xTM，即Map-WTR的x坐标减去Map-WTR中心点的x轴坐标后即为Map-TM的x轴坐标。
Map-WTR的x轴坐标映射到Map-TM的转换方式为yWTR为 Yc-yWTR=yTM，即Map-WTR中心点的y轴坐标减去Map-WTR的y坐标后即为Map-TM的y轴坐标。通过这样的方法将Map-WTR的95*95点阵映射到Map-TM来生成一个新的95*95点阵。

Map-TM点阵对应的二维数组需要存放的信息有“1. 坐标编号，2.Map-WTR的x轴坐标，3.Map-WTR的y轴坐标， 4.该坐标点处的刻蚀量TM（TrimmingAmount）”

接下来我将说明如何得到这个刻蚀量TM：
首先程序的使用者需要提供两个csv文件，一个文件的名称里需包含“initial”字样，表示这是晶圆刻蚀前的膜厚数据，另一个文件的名称里需包含“after”字样，表示这是同一个晶圆刻蚀后的膜厚数据。我发送两个文件你可以看一下。
这两个文件都是三列，第一列为x轴坐标，第二列为y轴坐标，第三列为晶圆表面的膜厚数值（WF-THK，代表晶圆膜厚）。Initial和After的csv文件的前两列坐标是完全一致的。这两个文件均通过测量同一个晶圆表面在刻蚀前与刻蚀后的膜厚得到。现在定义TM（TrimmingAmount）为initial的WF-THK和after的WF-THK的差值表示晶圆被刻蚀掉的厚度。
通过csv文件我们可以获得一套新的Map坐标（为了区分前面提到的两个Map我们称这一个Map为Map-WF），它的点阵并非是正方形的矩阵，而是不规则形状的。由于并非是n*m的矩形点阵，所以我想的办法是先检测出Map-WF的x/y坐标的最大最小值，然后用x和y轴的最大最小值为边界建立（xMax-xMin）*（yMax-yMin）的二维数组用于对应坐标，数组储存的内容为TM（TrimmingAmount）即intial的THK和after的THK的差，然后让Map-WF中不存在的坐标点保存的内容定位0即可。
这样我们就可以得到储存Map-WF这个点阵信息的另一个二维数组。这个二维数组每一个单元存放三个信息“1.Map-TM的x轴坐标，2.Map-TM的y轴坐标，3.Map-TM中该点对应的刻蚀量TrimmingAmount”（请注意目前为止一共出现了三个二维数组，分别是1、用于储存WedgeTestRecipe信息，对应Map-WTR的95*95尺寸的数组；2、Map-WTR进行映射后，对应Map-TM的同样为95*95的二维数组；以及3、对应晶圆的坐标Map-WF，用于储存TM的由initial或after文件生成的数组）

接下来是最重要的一步，就是将Map-WF这个二维数组中保存的TM（TrimmingAmount）的值传递给Map-TM。
实现方式是遍历Map-WF这个二维数组中保存有TM值的点，一旦发现Map-WF中和Map-TM有坐标相同的点（即Map-WF中某一个单元格的x/y轴坐标，与Map-TM中某一个单元格的x/y坐标一致）时，就把Map-WF这个二维数组中保存的TM的值传递给相同坐标对应单元的Map-TM的二维数组。这样Map-TM这个二维数组就获得了刻蚀量TM的数据，请注意，由于Map-WF和Map-TM并不是一一映射的，所以在Map-TM这个二维数组中并不是每个单元都会有TM（TrimmingAmount）的数据。

然后我需要使用Map-WTR这个二维数组和Map-TM这个二维数组，用这两个二维数组进行数据的计算：
我之前提过这两个二维数组是由映射关系得到的，而且这两个数组所对应的点的个数均为95*95，因此这两个数组上的点可以一一对应。现在我需要在Map-TM这个二维数组中找到保存有“TM（TrimmingAmount）数据的单元”，然后通过这个单元x/y坐标找到与之一一对应的Map-WTR数组中对应单元的“y轴的速度”。
举个例子，我在Map-TM这个二维数组的第58行，第30列（对应坐标Map-TM的坐标x为-36，y为-20）的这个单元中发现存有TM的数据，那么我通过这个单元格的Map-TM坐标为xTM=-36，yTM=-20，可以反过来计算得出这个坐标映射回Map-WTR所对应的坐标为xWTR=xTM+(Xcenter_of_Map-WTR)，yWTR=(Ycenter_of_Map-WTR)-yTM。假设Map-WTR的中点为（67.3，135.025），那么我们可以计算的到与Map-TM坐标为xTM=-36，yTM=-20对应的Map-WTR的点为 xWTR=31.3，yWTR=155.025。得到Map-WTR对应的坐标后通过Map-WTR这个二维数组可以找到，这是二维数组中第58行，第30列的单元中保存的数据，而单元中也能查找到，对应Map-WTR该点对应的y轴的速度。

得到所有的Map-TM二维数组中的“TM（TrimmingAmount）”以及与之对应的Map-WTR二维数组中的y轴速度“vy（velocity of y-axis）”后，在以1/vy（y轴的速度的倒数）为横轴，TM为纵轴，用线性回归拟合的方法计算出1/vy与TM的线性函数关系的斜率（令截距为0）。这个斜率就是该程序需要达到的最终目的。


